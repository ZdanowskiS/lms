{extends file="layout.html"}
{block name=title}::: LMS :{$layout.pagetitle|striphtml} :::{/block}
{block name=module_content}
<!--// $Id$ //-->
<H1>{$layout.pagetitle}</H1>
{$lastonline_limit = ConfigHelper::getConfig('phpui.lastonline_limit')}
<FORM method="get" action="?m={$layout.module}" name="choosefilter">
<p style="display: none;">
<INPUT type="submit" class="hiddenbtn">
<INPUT type="hidden" NAME="m" VALUE="proxmox_nodelist">
<INPUT type="hidden" NAME="page" VALUE="1">
</p>
<TABLE class="lmsbox lms-ui-background-cycle">
	<COLGROUP>
		<COL style="width: 20%;">
		<COL style="width: 20%;">
		<COL style="width: 20%;">
		<COL style="width: 1%;">
	</COLGROUP>
	<THEAD>
	<TR {tip text="Click on column name to change sorting order"}>
		<td scope="col">
			<SPAN class="nobr"><A href="?m=proxmox_nodelist&amp;o=name{if $listdata.direction eq "asc" && $listdata.order eq "name"},desc{/if}">{trans("Name")}:</A>{if $listdata.order eq "name"} <IMG SRC="img/{if $listdata.direction eq "desc"}asc{else}desc{/if}_order.gif" alt="">{/if}</SPAN><BR>
		</td>
		<td scope="col">
			<SPAN class="nobr"><A href="?m=proxmox_nodelist&amp;o=ipaddr{if $listdata.direction eq "asc" && $listdata.order eq "ipaddr"},desc{/if}">{trans("IP address:")}</A>{if $listdata.order eq "ipaddr"} <IMG SRC="img/{if $listdata.direction eq "desc"}asc{else}desc{/if}_order.gif" alt="">{/if}</SPAN><BR>
		</td>
		<td scope="col">
			{trans("ID")}:
		</td>
		<td scope="col" class="text-right nobr">

		</td>
	</TR>
	{if $pagination->getTotal() != 0}
	<TR>
		<TD class="lms-ui-pagination" colspan="4">
			{include file="pagination.html"}
		</TD>
	</TR>
	{/if}
	</THEAD>
	<TFOOT>
	{if $pagination->getTotal() != 0}
	<TR>
		<TD class="lms-ui-pagination" colspan="4">
			{include file="pagination.html"}
		</TD>
	</TR>
	{/if}
	</TFOOT>
	<TBODY>
    {foreach $nodelist as $node}
	{assign var=type value=$node.type}
	<TR class="highlight" data-target-url="?m=proxmox_nodeinfo&amp;id={$node.id}" 
data-name="{$node.name|escape:"javascript"|escape:"html"}">
		<TD class="bold nobr">
			{$node.name}
		</TD>
		<TD class="nobr">
			{$node.ipaddr}
		</TD>
		<TD class="nobr">
			({$node.id|string_format:"%04d"})
		</TD>
		<TD class="lms-ui-buttons text-right nobr">
            {button type="link" icon="delete" class="delete-node" tip="Delete" href="?m=proxmox_nodedel&amp;id={$node.id}"}
            {button type="link" icon="edit" tip="Edit" href="?m=proxmox_nodeedit&amp;id={$node.id}"}
            {button type="link" icon="info" tip="Info" href="?m=proxmox_nodeinfo&amp;id={$node.id}"}
		</TD>
	</TR>
	{foreachelse}
	<TR>
		<TD colspan="4" class="empty-table">
			<p>&nbsp;</p>
			<p>{trans("No matching nodes")}</p>
			<p>&nbsp;</p>
		</TD>
	</TR>
	{/foreach}
	</TBODY>
</TABLE>
</FORM>
<script>
	$(function() {
		$('.delete-node').click(function () {
			var name = $(this).closest('tr').attr('data-name');
			confirmDialog($t("Are you sure, you want to remove node '$a' from database?", name), this).done(function () {
				location.href = $(this).attr('href');
			});
			return false;
		});
	});
</script>
{/block}
